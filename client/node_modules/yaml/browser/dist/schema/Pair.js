<<<<<<< HEAD
import _classCallCheck from "@babel/runtime/helpers/classCallCheck";
import _createClass from "@babel/runtime/helpers/createClass";
import _possibleConstructorReturn from "@babel/runtime/helpers/possibleConstructorReturn";
import _getPrototypeOf from "@babel/runtime/helpers/getPrototypeOf";
import _inherits from "@babel/runtime/helpers/inherits";
import _typeof from "@babel/runtime/helpers/typeof";
// Published as 'yaml/pair'
import addComment from '../addComment';
import { Type } from '../constants';
import toJSON from '../toJSON';
import Collection from './Collection';
import Node from './Node';
import Scalar from './Scalar';

var stringifyKey = function stringifyKey(key, jsKey, ctx) {
  if (jsKey === null) return '';
  if (_typeof(jsKey) !== 'object') return String(jsKey);
  if (key instanceof Node && ctx && ctx.doc) return key.toString({
=======
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _addComment = _interopRequireDefault(require("../addComment"));

var _constants = require("../constants");

var _toJSON = _interopRequireDefault(require("../toJSON"));

var _Collection = _interopRequireDefault(require("./Collection"));

var _Node2 = _interopRequireDefault(require("./Node"));

var _Scalar = _interopRequireDefault(require("./Scalar"));

// Published as 'yaml/pair'
var stringifyKey = function stringifyKey(key, jsKey, ctx) {
  if (jsKey === null) return '';
  if ((0, _typeof2.default)(jsKey) !== 'object') return String(jsKey);
  if (key instanceof _Node2.default && ctx && ctx.doc) return key.toString({
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
    anchors: {},
    doc: ctx.doc,
    indent: '',
    inFlow: true,
    inStringifyKey: true
  });
  return JSON.stringify(jsKey);
};

<<<<<<< HEAD
var Pair = /*#__PURE__*/function (_Node) {
  _inherits(Pair, _Node);
=======
var Pair =
/*#__PURE__*/
function (_Node) {
  (0, _inherits2.default)(Pair, _Node);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0

  function Pair(key) {
    var _this;

    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
<<<<<<< HEAD

    _classCallCheck(this, Pair);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(Pair).call(this));
=======
    (0, _classCallCheck2.default)(this, Pair);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(Pair).call(this));
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
    _this.key = key;
    _this.value = value;
    _this.type = 'PAIR';
    return _this;
  }

<<<<<<< HEAD
  _createClass(Pair, [{
    key: "addToJSMap",
    value: function addToJSMap(ctx, map) {
      var key = toJSON(this.key, '', ctx);

      if (map instanceof Map) {
        var value = toJSON(this.value, key, ctx);
=======
  (0, _createClass2.default)(Pair, [{
    key: "addToJSMap",
    value: function addToJSMap(ctx, map) {
      var key = (0, _toJSON.default)(this.key, '', ctx);

      if (map instanceof Map) {
        var value = (0, _toJSON.default)(this.value, key, ctx);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
        map.set(key, value);
      } else if (map instanceof Set) {
        map.add(key);
      } else {
        var stringKey = stringifyKey(this.key, key, ctx);
<<<<<<< HEAD
        map[stringKey] = toJSON(this.value, stringKey, ctx);
=======
        map[stringKey] = (0, _toJSON.default)(this.value, stringKey, ctx);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
      }

      return map;
    }
  }, {
    key: "toJSON",
    value: function toJSON(_, ctx) {
      var pair = ctx && ctx.mapAsMap ? new Map() : {};
      return this.addToJSMap(ctx, pair);
    }
  }, {
    key: "toString",
    value: function toString(ctx, onComment, onChompKeep) {
      if (!ctx || !ctx.doc) return JSON.stringify(this);
      var simpleKeys = ctx.doc.options.simpleKeys;
      var key = this.key,
          value = this.value;
<<<<<<< HEAD
      var keyComment = key instanceof Node && key.comment;
=======
      var keyComment = key instanceof _Node2.default && key.comment;
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0

      if (simpleKeys) {
        if (keyComment) {
          throw new Error('With simple keys, key nodes cannot have comments');
        }

<<<<<<< HEAD
        if (key instanceof Collection) {
=======
        if (key instanceof _Collection.default) {
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
          var msg = 'With simple keys, collection cannot be used as a key value';
          throw new Error(msg);
        }
      }

<<<<<<< HEAD
      var explicitKey = !simpleKeys && (!key || keyComment || key instanceof Collection || key.type === Type.BLOCK_FOLDED || key.type === Type.BLOCK_LITERAL);
=======
      var explicitKey = !simpleKeys && (!key || keyComment || key instanceof _Collection.default || key.type === _constants.Type.BLOCK_FOLDED || key.type === _constants.Type.BLOCK_LITERAL);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
      var _ctx = ctx,
          doc = _ctx.doc,
          indent = _ctx.indent;
      ctx = Object.assign({}, ctx, {
        implicitKey: !explicitKey,
        indent: indent + '  '
      });
      var chompKeep = false;
      var str = doc.schema.stringify(key, ctx, function () {
        return keyComment = null;
      }, function () {
        return chompKeep = true;
      });
<<<<<<< HEAD
      str = addComment(str, ctx.indent, keyComment);

      if (ctx.allNullValues && !simpleKeys) {
        if (this.comment) {
          str = addComment(str, ctx.indent, this.comment);
=======
      str = (0, _addComment.default)(str, ctx.indent, keyComment);

      if (ctx.allNullValues && !simpleKeys) {
        if (this.comment) {
          str = (0, _addComment.default)(str, ctx.indent, this.comment);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
          if (onComment) onComment();
        } else if (chompKeep && !keyComment && onChompKeep) onChompKeep();

        return ctx.inFlow ? str : "? ".concat(str);
      }

      str = explicitKey ? "? ".concat(str, "\n").concat(indent, ":") : "".concat(str, ":");

      if (this.comment) {
        // expected (but not strictly required) to be a single-line comment
<<<<<<< HEAD
        str = addComment(str, ctx.indent, this.comment);
=======
        str = (0, _addComment.default)(str, ctx.indent, this.comment);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
        if (onComment) onComment();
      }

      var vcb = '';
      var valueComment = null;

<<<<<<< HEAD
      if (value instanceof Node) {
=======
      if (value instanceof _Node2.default) {
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
        if (value.spaceBefore) vcb = '\n';

        if (value.commentBefore) {
          var cs = value.commentBefore.replace(/^/gm, "".concat(ctx.indent, "#"));
          vcb += "\n".concat(cs);
        }

        valueComment = value.comment;
<<<<<<< HEAD
      } else if (value && _typeof(value) === 'object') {
=======
      } else if (value && (0, _typeof2.default)(value) === 'object') {
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
        value = doc.schema.createNode(value, true);
      }

      ctx.implicitKey = false;
<<<<<<< HEAD
      if (!explicitKey && !this.comment && value instanceof Scalar) ctx.indentAtStart = str.length + 1;
=======
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
      chompKeep = false;
      var valueStr = doc.schema.stringify(value, ctx, function () {
        return valueComment = null;
      }, function () {
        return chompKeep = true;
      });
      var ws = ' ';

      if (vcb || this.comment) {
        ws = "".concat(vcb, "\n").concat(ctx.indent);
<<<<<<< HEAD
      } else if (!explicitKey && value instanceof Collection) {
=======
      } else if (!explicitKey && value instanceof _Collection.default) {
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
        var flow = valueStr[0] === '[' || valueStr[0] === '{';
        if (!flow || valueStr.includes('\n')) ws = "\n".concat(ctx.indent);
      }

      if (chompKeep && !valueComment && onChompKeep) onChompKeep();
<<<<<<< HEAD
      return addComment(str + ws + valueStr, ctx.indent, valueComment);
=======
      return (0, _addComment.default)(str + ws + valueStr, ctx.indent, valueComment);
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
    }
  }, {
    key: "commentBefore",
    get: function get() {
      return this.key && this.key.commentBefore;
    },
    set: function set(cb) {
<<<<<<< HEAD
      if (this.key == null) this.key = new Scalar(null);
      this.key.commentBefore = cb;
    }
  }]);

  return Pair;
}(Node);

export { Pair as default };
=======
      if (this.key == null) this.key = new _Scalar.default(null);
      this.key.commentBefore = cb;
    }
  }]);
  return Pair;
}(_Node2.default);

exports.default = Pair;
>>>>>>> 087c3e111e0f389a3f9a8381d37edf4f644326b0
